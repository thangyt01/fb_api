<html>

<head>
  <script src="https://cdn.socket.io/4.3.2/socket.io.min.js"
    integrity="sha384-KAZ4DtjNhLChOB/hxXuKqhMLYvx3b5MlT55xPEiNmREKRzeEm+RVPlTnAn0ajQNs" crossorigin="anonymous">
    </script>

</head>

<body>
  <h1>Đề xuất</h1>
  <p>Token user_id 1:
    <input type="text"
      value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJ0aGFuZ3l0MDBAZ21haWwuY29tIiwiZGV2aWNlSWQiOiIxMjM0IiwiaWF0IjoxNjcxOTQwMjk1LCJleHAiOjE2NzMyMzYyOTV9.Qbyg2sANA0UYdsCqNVMXryuF4tp3LeaA5JKMbDWwT1c">
  </p>
  <p>Token user_id 6:
    <input type="text"
      value="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NiwiZW1haWwiOiJia3MyMDIyQGdtYWlsLmNvbSIsImRldmljZUlkIjo2LCJpYXQiOjE2NzE5NDA2NjEsImV4cCI6MTY3MzIzNjY2MX0.ihpIM7jljQfM6bWFED6eLv7LLrdrQGyJg-aWOZhxFss">
  </p>
  <p>group_chat_id: 63a7c9c154a4ae27c8db48cf
  </p>
  <h1>Đề xuất</h1>
  <label for="">Token</label>
  <input type="text" class="token">
  <button class="btn_token">Set Token</button>
  <h1>TOOL CHECK SOCKET</h1>
  <ul>
    <li>
      <label for="">Gửi tin nhắn</label>
      <input type="text" class="group_chat_id" placeholder="Điền group chat id">
      <input type="text" class="messages" placeholder="Soạn tin nhắn">
      <button onclick="sendMessage()" class="sendMsg">sendMessage</button>
    </li>
  </ul>
</body>
<script>
  const sendMsgElmt = document.querySelector('.sendMsg')
  const groupChatIdElmt = document.querySelector('.group_chat_id')
  const MsgElmt = document.querySelector('.messages')
  function sendMessage() {
    socket.emit('server-new-chat', {
      group_chat_id: groupChatIdElmt.value,
      content: MsgElmt.value,
    })
  }
  // example namespace http://localhost:8000/${namespace}
  const tokenElm = document.querySelector('.token')
  const tokenBtnElm = document.querySelector('.btn_token')
  var socket
  tokenBtnElm.addEventListener('click', function () {
    socket = io('http://localhost:8000/', {
      query: {
        'accessToken': `Bearer ${tokenElm.value}`
      },
      transports: ["websocket"]
    });
    socket.on('connect', function () {
      console.log('Connected');
      setTimeout(() => {
        console.log("join room")
        socket.emit('join-room', 123)
      }, 1000)
    });
    socket.on('client-new-chat', data => {
      console.log("message", data)
    })
    socket.on('disconnect', function () {
      console.log('Disconnected');
    });
  })
</script>

</html>